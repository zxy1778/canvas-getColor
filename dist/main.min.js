"use strict";!function(t,e){function i(){var e=s.getBoundingClientRect().width;e/r>540&&(e=540*r);var i=e/10;s.style.fontSize=i+"px",h.rem=t.rem=i}var o,n=t.document,s=n.documentElement,a=n.querySelector('meta[name="viewport"]'),l=n.querySelector('meta[name="flexible"]'),r=0,c=0,h=e.flexible||(e.flexible={});if(a){console.warn("将根据已有的meta标签来设置缩放比例");var p=a.getAttribute("content").match(/initial\-scale=([\d\.]+)/);p&&(c=parseFloat(p[1]),r=parseInt(1/c))}else if(l){var d=l.getAttribute("content");if(d){var g=d.match(/initial\-dpr=([\d\.]+)/),u=d.match(/maximum\-dpr=([\d\.]+)/);g&&(r=parseFloat(g[1]),c=parseFloat((1/r).toFixed(2))),u&&(r=parseFloat(u[1]),c=parseFloat((1/r).toFixed(2)))}}if(!r&&!c){var f=t.navigator.userAgent,m=(!!f.match(/android/gi),!!f.match(/iphone/gi)),_=m&&!!f.match(/OS 9_3/),x=t.devicePixelRatio;r=m&&!_?x>=3&&(!r||r>=3)?3:x>=2&&(!r||r>=2)?2:1:1,c=1/r}if(s.setAttribute("data-dpr",r),!a)if(a=n.createElement("meta"),a.setAttribute("name","viewport"),a.setAttribute("content","initial-scale="+c+", maximum-scale="+c+", minimum-scale="+c+", user-scalable=no"),s.firstElementChild)s.firstElementChild.appendChild(a);else{var v=n.createElement("div");v.appendChild(a),n.write(v.innerHTML)}t.addEventListener("resize",function(){clearTimeout(o),o=setTimeout(i,300)},!1),t.addEventListener("pageshow",function(t){t.persisted&&(clearTimeout(o),o=setTimeout(i,300))},!1),"complete"===n.readyState?n.body.style.fontSize=12*r+"px":n.addEventListener("DOMContentLoaded",function(){n.body.style.fontSize=12*r+"px"},!1),i(),h.dpr=t.dpr=r,h.refreshRem=i,h.rem2px=function(t){var e=parseFloat(t)*this.rem;return"string"==typeof t&&t.match(/rem$/)&&(e+="px"),e},h.px2rem=function(t){var e=parseFloat(t)/this.rem;return"string"==typeof t&&t.match(/px$/)&&(e+="rem"),e}}(window,window.lib||(window.lib={}));var getcolor=function(t){var e={ele:$("#cav")};this.opt=$.extend({},t,e),this.ctx=this.opt.ele[0].getContext("2d"),this.radio=40,this.color=0,this.init()};$.extend(getcolor.prototype,{init:function(){var t=$(window)[0].innerWidth;this.opt.ele.attr({width:1*t,height:1*t}),this.opt.ele.css({width:.5*t,height:.5*t,"border-radius":.3*t}),this._render(),this.touchEvent()},_render:function(t,e){this.renderbg(),this.renderspot(t,e)},renderbg:function(){this.ctx.save();var t=this.opt.ele.attr("width")/2,e=this.opt.ele.attr("height")/2,i=0,o=.1,n=o*Math.PI/180,s=0;for(this.ctx.save(),this.ctx.translate(t,e);i<360;i+=o)this.ctx.beginPath(),s++,s<18?this.ctx.strokeStyle="hsla("+i+", 100%, 50%,0)":s>=18&&s<=120&&(this.ctx.strokeStyle="hsla("+i+", 100%, 50%,1)",120==s&&(s=0)),this.ctx.lineWidth=1,this.ctx.rotate(n),this.ctx.moveTo(t-15,0),this.ctx.lineTo(t-this.radio-15,0),this.ctx.stroke(),this.ctx.closePath();this.ctx.restore()},renderspot:function(t,e){var i=this.opt.ele.attr("width")/2,o=this.opt.ele.attr("height")/2,n=0;this.ctx.save(),this.ctx.translate(i,o);var s=t-this.opt.ele.width()/2,a=e-this.opt.ele.height()/2;if(void 0==arguments[0])this.color=0;else{n=Math.atan2(a,s);var l=180*n/Math.PI;l<0&&(l=180+l+180),this.color=l}this.ctx.rotate(n),this.ctx.beginPath(),this.ctx.lineWidth=8,this.ctx.arc(i-this.radio/2-18,0,this.radio/1.2,0,2*Math.PI,!1),this.ctx.strokeStyle="#fff",this.ctx.fillStyle="hsla("+this.color+", 100%, 50%, 1)",this.ctx.stroke(),this.ctx.fill(),this.ctx.restore()},touchEvent:function(){var t=this,e=this.opt.ele.attr("width"),i=this.opt.ele.attr("height");this.opt.ele[0].addEventListener("touchstart",function(o){var n=o.touches[0],s=n.pageX||n.clientX,a=n.pageY||n.clientY,l=t.opt.ele.offset().top,r=t.opt.ele.offset().left,c=s-r,h=a-l;t.ctx.clearRect(0,0,e,i),t._render(c,h)},!1),this.opt.ele[0].addEventListener("touchmove",function(o){var n=o.touches[0],s=n.pageX||n.clientX,a=n.pageY||n.clientY,l=t.opt.ele.offset().top,r=t.opt.ele.offset().left,c=s-r,h=a-l;t.ctx.clearRect(0,0,e,i),t._render(c,h)},!1),this.opt.ele[0].addEventListener("touchend",function(){t.opt.readColor(t.opt.staur,t.opt.inten,t.color,t.opt.isopen)},!1)}});var isWhite=!0,isopen=!1,intensity=60,saturation=.8,colour_int=60,colour_satur=.8,changeLight=function(t,e,i,o){"#fff"!=i?$(".lamp_btm, .lamp_top, .lamp_mid").css({background:"#fff","box-shadow":"0 0 "+e+"px 3px hsla("+i+", 100%, 50%, "+t+")"}):"#fff"==i&&(o?$(".lamp_btm, .lamp_top, .lamp_mid").css({background:"rgba(255, 255, 255, "+t+")","box-shadow":"0 0 "+e+"px 3px rgba(255, 255, 255, "+t+")"}):$(".lamp_btm, .lamp_top, .lamp_mid").css({background:"#10042e","box-shadow":"none"}))},option={readColor:changeLight,staur:colour_satur,inten:colour_int,isopen:isopen},colorPicker=new getcolor(option);$("#cav").hide(),$(".switch").click(function(){$(this).children(".swt").toggleClass("swt_close"),$(this).children(".swt").toggleClass("swt_open")}),$(".container").css("height",.5*$(window).width()),$("#cav").css("margin-left",.5*-$("#cav").width()),$(".lamp").click(function(){isopen=!isopen,changeLight(saturation,intensity,"#fff",isopen),$(".control").toggleClass("control_in")}),$("#intensity").change(function(){isopen&&(intensity=$(this).val(),changeLight(saturation,intensity,"#fff",isopen))}),$("#saturation").change(function(){isopen&&(saturation=$(this).val()/100,changeLight(saturation,intensity,"#fff",isopen))}),$(".white_light .light_close").click(function(){$(".infor").toggleClass("info_close"),$(".control").toggleClass("control_in"),$(".white_light").addClass("white_light_close")}),$(".cont_item").eq(0).click(function(){isWhite=!0,$(".infor").toggleClass("info_close"),$(".control").toggleClass("control_in"),$(".white_light").toggleClass("white_light_open")}),$(".cont_item").eq(1).click(function(){$("#cav").show()}),$(".colour_light .light_close").click(function(){$(".infor").toggleClass("info_close"),$(".control").toggleClass("control_in"),$(".colour_light").addClass("white_light_close")}),$(".cont_item").eq(1).click(function(){isWhite=!1,$(".infor").toggleClass("info_close"),$(".control").toggleClass("control_in"),$(".colour_light").toggleClass("white_light_open"),changeLight(colour_satur,colour_int,0,isopen)}),$("#colour_intensity").change(function(){isopen&&(colour_int=$(this).val(),changeLight(colour_satur,colour_int,0,isopen))}),$("#colour_saturation").change(function(){isopen&&(colour_satur=$(this).val()/100,changeLight(colour_satur,colour_int,0,isopen))});