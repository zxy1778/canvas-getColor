"use strict";!function(t,e){function i(){var e=n.getBoundingClientRect().width;e/r>540&&(e=540*r);var i=e/10;n.style.fontSize=i+"px",h.rem=t.rem=i}var o,s=t.document,n=s.documentElement,l=s.querySelector('meta[name="viewport"]'),a=s.querySelector('meta[name="flexible"]'),r=0,c=0,h=e.flexible||(e.flexible={});if(l){console.warn("将根据已有的meta标签来设置缩放比例");var p=l.getAttribute("content").match(/initial\-scale=([\d\.]+)/);p&&(c=parseFloat(p[1]),r=parseInt(1/c))}else if(a){var d=a.getAttribute("content");if(d){var g=d.match(/initial\-dpr=([\d\.]+)/),f=d.match(/maximum\-dpr=([\d\.]+)/);g&&(r=parseFloat(g[1]),c=parseFloat((1/r).toFixed(2))),f&&(r=parseFloat(f[1]),c=parseFloat((1/r).toFixed(2)))}}if(!r&&!c){var u=t.navigator.userAgent,_=(!!u.match(/android/gi),!!u.match(/iphone/gi)),m=_&&!!u.match(/OS 9_3/),v=t.devicePixelRatio;r=_&&!m?v>=3&&(!r||r>=3)?3:v>=2&&(!r||r>=2)?2:1:1,c=1/r}if(n.setAttribute("data-dpr",r),!l)if(l=s.createElement("meta"),l.setAttribute("name","viewport"),l.setAttribute("content","initial-scale="+c+", maximum-scale="+c+", minimum-scale="+c+", user-scalable=no"),n.firstElementChild)n.firstElementChild.appendChild(l);else{var w=s.createElement("div");w.appendChild(l),s.write(w.innerHTML)}t.addEventListener("resize",function(){clearTimeout(o),o=setTimeout(i,300)},!1),t.addEventListener("pageshow",function(t){t.persisted&&(clearTimeout(o),o=setTimeout(i,300))},!1),"complete"===s.readyState?s.body.style.fontSize=12*r+"px":s.addEventListener("DOMContentLoaded",function(){s.body.style.fontSize=12*r+"px"},!1),i(),h.dpr=t.dpr=r,h.refreshRem=i,h.rem2px=function(t){var e=parseFloat(t)*this.rem;return"string"==typeof t&&t.match(/rem$/)&&(e+="px"),e},h.px2rem=function(t){var e=parseFloat(t)/this.rem;return"string"==typeof t&&t.match(/px$/)&&(e+="rem"),e}}(window,window.lib||(window.lib={}));var getcolor=function(t){var e={ele:$("#cav")};this.opt=$.extend({},t,e),this.ctx=this.opt.ele[0].getContext("2d"),this.radio=40,this.color=270,this.init()};$.extend(getcolor.prototype,{init:function(){var t=$(window)[0].innerWidth;this.opt.ele.attr({width:1*t,height:1*t}),this.opt.ele.css({width:.5*t,height:.5*t,"border-radius":.3*t}),this._render(),this.touchEvent()},_render:function(t,e){this.renderbg(),this.renderspot(t,e)},renderbg:function(){this.ctx.save();var t=this.opt.ele.attr("width")/2,e=this.opt.ele.attr("height")/2,i=0,o=.1,s=o*Math.PI/180,n=0;for(this.ctx.save(),this.ctx.translate(t,e);i<360;i+=o)this.ctx.beginPath(),n++,n<18?this.ctx.strokeStyle="hsla("+i+", 100%, 50%,0)":n>=18&&n<=120&&(this.ctx.strokeStyle="hsla("+i+", 100%, 50%,1)",120==n&&(n=0)),this.ctx.lineWidth=1,this.ctx.rotate(s),this.ctx.moveTo(t-15,0),this.ctx.lineTo(t-this.radio-15,0),this.ctx.stroke(),this.ctx.closePath();this.ctx.restore()},renderspot:function(t,e){var i=this.opt.ele.attr("width")/2,o=this.opt.ele.attr("height")/2,s=0;this.ctx.save(),this.ctx.translate(i,o);var n=t-this.opt.ele.width()/2,l=e-this.opt.ele.height()/2;if(void 0==arguments[0])this.color=270;else{s=Math.atan2(l,n);var a=180*s/Math.PI;a<0&&(a=180+a+180),this.color=a,s+=Math.PI/2}this.ctx.rotate(s),this.ctx.beginPath(),this.ctx.lineWidth=8,this.ctx.arc(0,-i+(this.radio/2+18),this.radio/1.2,0,2*Math.PI,!1),this.ctx.strokeStyle="#fff",this.ctx.fillStyle="hsla("+this.color+", 100%, 50%, 1)",this.ctx.stroke(),this.ctx.fill(),this.ctx.restore()},touchEvent:function(){var t=this,e=this.opt.ele.attr("width"),i=this.opt.ele.attr("height");this.opt.ele[0].addEventListener("touchstart",function(o){var s=o.touches[0],n=s.pageX||s.clientX,l=s.pageY||s.clientY,a=t.opt.ele.offset().top,r=t.opt.ele.offset().left,c=n-r,h=l-a;t.ctx.clearRect(0,0,e,i),t._render(c,h)},!1),this.opt.ele[0].addEventListener("touchmove",function(o){var s=o.touches[0],n=s.pageX||s.clientX,l=s.pageY||s.clientY,a=t.opt.ele.offset().top,r=t.opt.ele.offset().left,c=n-r,h=l-a;t.ctx.clearRect(0,0,e,i),t._render(c,h)},!1),this.opt.ele[0].addEventListener("touchend",function(){t.opt.readColor(t.opt.staur,t.opt.inten,t.color,t.opt.isopen)},!1)}});var isWhite=!0,isopen=!1,intensity=60,saturation=.8,colour_int=60,colour_satur=.8,changeLight=function(t,e,i,o){"#fff"!=i?$(".lamp_btm, .lamp_top, .lamp_mid").css({background:"#fff","box-shadow":"0 0 "+e+"px 3px hsla("+i+", 100%, 50%, "+t+")"}):"#fff"==i&&(o?$(".lamp_btm, .lamp_top, .lamp_mid").css({background:"rgba(255, 255, 255, "+t+")","box-shadow":"0 0 "+e+"px 3px rgba(255, 255, 255, "+t+")"}):$(".lamp_btm, .lamp_top, .lamp_mid").css({background:"#10042e","box-shadow":"none"}))},option={readColor:changeLight,staur:colour_satur,inten:colour_int,isopen:isopen},colorPicker=new getcolor(option);$("#cav").hide(),$(".switch").click(function(){$(this).children(".swt").toggleClass("swt_close"),$(this).children(".swt").toggleClass("swt_open")}),$(".container").css("height",.5*$(window).width()),$("#cav").css("margin-left",.5*-$("#cav").width()),$(".lamp").click(function(){isWhite&&(isopen=!isopen,isopen?(changeLight(saturation,intensity,"#fff",isopen),$(".control").addClass("control_in"),$(".infor").removeClass("info_close"),$(".colour_light").addClass("white_light_close").removeClass("white_light_open"),$(".white_light").addClass("white_light_close").removeClass("white_light_open")):(changeLight(saturation,intensity,"#fff",isopen),$(".control").removeClass("control_in"),$(".infor").removeClass("info_close"),$(".colour_light").addClass("white_light_close").removeClass("white_light_open"),$(".white_light").addClass("white_light_close").removeClass("white_light_open")))}),$("#intensity").change(function(){isopen&&(intensity=$(this).val(),changeLight(saturation,intensity,"#fff",isopen))}),$("#saturation").change(function(){isopen&&(saturation=$(this).val()/100,changeLight(saturation,intensity,"#fff",isopen))}),$(".white_light .light_close").click(function(){$(".infor").removeClass("info_close"),$(".control").toggleClass("control_in"),$(".white_light").toggleClass("white_light_close").toggleClass("white_light_open")}),$(".cont_item").eq(0).click(function(){isWhite=!0,changeLight(saturation,intensity,"#fff",isopen),$(".infor").addClass("info_close"),$(".control").toggleClass("control_in"),$(".white_light").removeClass("white_light_close").addClass("white_light_open")}),$(".cont_item").eq(1).click(function(){$("#cav").show()}),$(".colour_light .light_close").click(function(){isWhite=!0,$("#cav").hide(),$(".infor").removeClass("info_close"),$(".control").toggleClass("control_in"),$(".colour_light").toggleClass("white_light_close").toggleClass("white_light_open")}),$(".cont_item").eq(1).click(function(){isWhite=!1,$(".infor").addClass("info_close"),$(".control").toggleClass("control_in"),$(".colour_light").removeClass("white_light_close").addClass("white_light_open"),changeLight(colour_satur,colour_int,270,isopen)}),$("#colour_intensity").change(function(){isopen&&(colour_int=$(this).val(),changeLight(colour_satur,colour_int,0,isopen))}),$("#colour_saturation").change(function(){isopen&&(colour_satur=$(this).val()/100,changeLight(colour_satur,colour_int,0,isopen))});